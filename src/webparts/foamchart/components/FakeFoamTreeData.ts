
/***
 *    d888888b .88b  d88. d8888b.  .d88b.  d8888b. d888888b       .d88b.  d88888b d88888b d888888b  .o88b. d888888b  .d8b.  db      
 *      `88'   88'YbdP`88 88  `8D .8P  Y8. 88  `8D `~~88~~'      .8P  Y8. 88'     88'       `88'   d8P  Y8   `88'   d8' `8b 88      
 *       88    88  88  88 88oodD' 88    88 88oobY'    88         88    88 88ooo   88ooo      88    8P         88    88ooo88 88      
 *       88    88  88  88 88~~~   88    88 88`8b      88         88    88 88~~~   88~~~      88    8b         88    88~~~88 88      
 *      .88.   88  88  88 88      `8b  d8' 88 `88.    88         `8b  d8' 88      88        .88.   Y8b  d8   .88.   88   88 88booo. 
 *    Y888888P YP  YP  YP 88       `Y88P'  88   YD    YP          `Y88P'  YP      YP      Y888888P  `Y88P' Y888888P YP   YP Y88888P 
 *                                                                                                                                  
 *                                                                                                                                  
 */


/***
 *    d888888b .88b  d88. d8888b.  .d88b.  d8888b. d888888b      d8b   db d8888b. .88b  d88.      d88888b db    db d8b   db  .o88b. d888888b d888888b  .d88b.  d8b   db .d8888. 
 *      `88'   88'YbdP`88 88  `8D .8P  Y8. 88  `8D `~~88~~'      888o  88 88  `8D 88'YbdP`88      88'     88    88 888o  88 d8P  Y8 `~~88~~'   `88'   .8P  Y8. 888o  88 88'  YP 
 *       88    88  88  88 88oodD' 88    88 88oobY'    88         88V8o 88 88oodD' 88  88  88      88ooo   88    88 88V8o 88 8P         88       88    88    88 88V8o 88 `8bo.   
 *       88    88  88  88 88~~~   88    88 88`8b      88         88 V8o88 88~~~   88  88  88      88~~~   88    88 88 V8o88 8b         88       88    88    88 88 V8o88   `Y8b. 
 *      .88.   88  88  88 88      `8b  d8' 88 `88.    88         88  V888 88      88  88  88      88      88b  d88 88  V888 Y8b  d8    88      .88.   `8b  d8' 88  V888 db   8D 
 *    Y888888P YP  YP  YP 88       `Y88P'  88   YD    YP         VP   V8P 88      YP  YP  YP      YP      ~Y8888P' VP   V8P  `Y88P'    YP    Y888888P  `Y88P'  VP   V8P `8888Y' 
 *                                                                                                                                                                              
 *                                                                                                                                                                              
 */

/***
 *    d888888b .88b  d88. d8888b.  .d88b.  d8888b. d888888b      .d8888. d88888b d8888b. db    db d888888b  .o88b. d88888b .d8888. 
 *      `88'   88'YbdP`88 88  `8D .8P  Y8. 88  `8D `~~88~~'      88'  YP 88'     88  `8D 88    88   `88'   d8P  Y8 88'     88'  YP 
 *       88    88  88  88 88oodD' 88    88 88oobY'    88         `8bo.   88ooooo 88oobY' Y8    8P    88    8P      88ooooo `8bo.   
 *       88    88  88  88 88~~~   88    88 88`8b      88           `Y8b. 88~~~~~ 88`8b   `8b  d8'    88    8b      88~~~~~   `Y8b. 
 *      .88.   88  88  88 88      `8b  d8' 88 `88.    88         db   8D 88.     88 `88.  `8bd8'    .88.   Y8b  d8 88.     db   8D 
 *    Y888888P YP  YP  YP 88       `Y88P'  88   YD    YP         `8888Y' Y88888P 88   YD    YP    Y888888P  `Y88P' Y88888P `8888Y' 
 *                                                                                                                                 
 *                                                                                                                                 
 */


 /***
 *    d888888b .88b  d88. d8888b.  .d88b.  d8888b. d888888b      db   db d88888b db      d8888b. d88888b d8888b. .d8888. 
 *      `88'   88'YbdP`88 88  `8D .8P  Y8. 88  `8D `~~88~~'      88   88 88'     88      88  `8D 88'     88  `8D 88'  YP 
 *       88    88  88  88 88oodD' 88    88 88oobY'    88         88ooo88 88ooooo 88      88oodD' 88ooooo 88oobY' `8bo.   
 *       88    88  88  88 88~~~   88    88 88`8b      88         88~~~88 88~~~~~ 88      88~~~   88~~~~~ 88`8b     `Y8b. 
 *      .88.   88  88  88 88      `8b  d8' 88 `88.    88         88   88 88.     88booo. 88      88.     88 `88. db   8D 
 *    Y888888P YP  YP  YP 88       `Y88P'  88   YD    YP         YP   YP Y88888P Y88888P 88      Y88888P 88   YD `8888Y' 
 *                                                                                                                       
 *                                                                                                                       
 */

 /***
 *    d888888b .88b  d88. d8888b.  .d88b.  d8888b. d888888b       .o88b.  .d88b.  .88b  d88. d8888b.  .d88b.  d8b   db d88888b d8b   db d888888b 
 *      `88'   88'YbdP`88 88  `8D .8P  Y8. 88  `8D `~~88~~'      d8P  Y8 .8P  Y8. 88'YbdP`88 88  `8D .8P  Y8. 888o  88 88'     888o  88 `~~88~~' 
 *       88    88  88  88 88oodD' 88    88 88oobY'    88         8P      88    88 88  88  88 88oodD' 88    88 88V8o 88 88ooooo 88V8o 88    88    
 *       88    88  88  88 88~~~   88    88 88`8b      88         8b      88    88 88  88  88 88~~~   88    88 88 V8o88 88~~~~~ 88 V8o88    88    
 *      .88.   88  88  88 88      `8b  d8' 88 `88.    88         Y8b  d8 `8b  d8' 88  88  88 88      `8b  d8' 88  V888 88.     88  V888    88    
 *    Y888888P YP  YP  YP 88       `Y88P'  88   YD    YP          `Y88P'  `Y88P'  YP  YP  YP 88       `Y88P'  VP   V8P Y88888P VP   V8P    YP    
 *                                                                                                                                               
 *                                                                                                                                               
 */

import { IFoamTree, IFoamTreeDataObject, IFoamTreeGroup } from '@mikezimm/npmfunctions/dist/IFoamTree';

/***
 *    d88888b db    db d8888b.  .d88b.  d8888b. d888888b      d888888b d8b   db d888888b d88888b d8888b. d88888b  .d8b.   .o88b. d88888b .d8888. 
 *    88'     `8b  d8' 88  `8D .8P  Y8. 88  `8D `~~88~~'        `88'   888o  88 `~~88~~' 88'     88  `8D 88'     d8' `8b d8P  Y8 88'     88'  YP 
 *    88ooooo  `8bd8'  88oodD' 88    88 88oobY'    88            88    88V8o 88    88    88ooooo 88oobY' 88ooo   88ooo88 8P      88ooooo `8bo.   
 *    88~~~~~  .dPYb.  88~~~   88    88 88`8b      88            88    88 V8o88    88    88~~~~~ 88`8b   88~~~   88~~~88 8b      88~~~~~   `Y8b. 
 *    88.     .8P  Y8. 88      `8b  d8' 88 `88.    88           .88.   88  V888    88    88.     88 `88. 88      88   88 Y8b  d8 88.     db   8D 
 *    Y88888P YP    YP 88       `Y88P'  88   YD    YP         Y888888P VP   V8P    YP    Y88888P 88   YD YP      YP   YP  `Y88P' Y88888P `8888Y' 
 *                                                                                                                                               
 *                                                                                                                                               
 */

 export const fakeGroups0 = ['Americas', 'Europe', 'Asia'];
 export const fakeGroups1 = [ ['US','Canada','Mexico','Brazil'], ['Sweden','Germany','France','Romania','Spain','Austria','Italy','Switzerland','England'], ['China','Japan','Thailand','India'] ];

 export const IFoamRoundBorders = {
    groupBorderRadius: 1,
    groupFillGradientCenterLightnessShift: 30,
    groupFillGradientRimSaturationShift: 20,
    groupFillGradientRimLightnessShift: -15
  };

 let products = ['AB','SB','SW'];

 function getFakeLayer3() {
    let fg3 : [][][] = [];
    fakeGroups1.map( ( group1, index1 )  => {
        let groupProducts = [];
        products.map( ( group0, index2 )  => {
            groupProducts.push( group0 );
        });
        fg3.push( groupProducts );

    });
    //console.log('getFakeLayer3', fg3 );

    return fg3;
 }


 export function getEmptyFoamTreeData(  ) {

    let preConfigFoamTree : IFoamTree = {
      descriptionGroupType: 'stab',
      id: "visualization" ,
      //exposeDuration: 400, //This is not on IFoamTree yet
      //exposeEasing: "linear", //This is not on IFoamTree yet
      groupLabelFontFamily: "Oxygen",
      rolloutEasing: "squareInOut",
      rolloutScalingStrength: -0.3,
      rolloutRotationStrength: 0,
      pullbackEasing: "squareInOut",
      pullbackDuration: 2000,
      pullbackScalingStrength: -0.3,
      pullbackRotationStrength: 0,
      showZeroWeightGroups: false,
      //pullbackPolygonDelay: 0.1, //This is not on IFoamTree yet
      fadeDuration: 0,
      //attributionPosition: 45, //This is not on IFoamTree yet
      relaxationVisible: true,
      groupGrowingDuration: 500,
      layout: 'relaxed',//squarified, ordered, relaxed
      
      stacking: 'hierarchical', //hierarchical, flattened
      //descriptionGroupMinHeight: 100,
      //descriptionGroupSize: 0,
      //groupLabelLineHeight: 1.1,
      //groupLabelMinFontSize: 8,
      //attributionPosition: 4,

      dataObject: {
          groups: [],
        },
    };

    //return preConfigFoamTree;

    let emptyOrdered : IFoamTree = {
      id: "visualization" ,
      layout: "ordered",
      stacking: "flattened",
      descriptionGroupSize: 0.33,
      descriptionGroupMinHeight: 22,
      dataObject: {
        groups: [],
      },
    };

    
    let emptyRelaxed : IFoamTree = {
      id: "visualization" ,
      layout: "relaxed",
      stacking: "flattened",
      descriptionGroupSize: 0.33,
      descriptionGroupMinHeight: 22,
      groupLabelFontFamily: "Oxygen",
      groupLabelMinFontSize: 13,

/* 
      groupLabelFontFamily: "Oxygen",
      rolloutEasing: "squareInOut",
      rolloutScalingStrength: -0.3,
      rolloutRotationStrength: 0,
      pullbackEasing: "squareInOut",
      pullbackDuration: 2000,
      pullbackScalingStrength: -0.3,
      pullbackRotationStrength: 0,
      
*/
      pullbackDuration: 1000,
      //pullbackPolygonDelay: 0.1, //This is not on IFoamTree yet
      fadeDuration: 1000,
      rolloutDuration: 1000,
/*    This did not scale right at all
      fadeDuration: 1000,
      rolloutDuration: 0,
*/
      //attributionPosition: 45, //This is not on IFoamTree yet
      relaxationVisible: true,
      
//      groupGrowingDuration: 500,


      showZeroWeightGroups: false,
      relaxationInitializer: 'squarified', //blackhole & fisheye make subgroups not scaled
      dataObject: {
        groups: [],
      },
    };

    //console.log('thisFoamTree', thisFoamTree );
    return emptyRelaxed;

}


export function getFakeFoamTreeData( useFlatEU : boolean, weightFlatness: number ) {
    let fg3 = getFakeLayer3();

    let groups = useFlatEU === false ? getFakeFoamTreeGroups( weightFlatness, 1000, fakeGroups0 , fakeGroups1 ) : getFakeFoamTreeGroups( weightFlatness, 1000, fakeGroups1[1] );

    let thisFoamTree : IFoamTree = {
        descriptionGroupType: 'stab',
        id: "visualization" ,
        fadeDuration: 1500,
        layoutByWeightOrder: false,
        stacking: 'flattened',
        layout: 'squarified',//squarified, ordered, relaxed
        // Show the relaxation
        relaxationVisible: true,
        // Make the relaxation last longer
        relaxationQualityThreshold: 0,
        relaxationMaxDuration: 5000,
        dataObject: {
          groups: groups,
        },

        groupSelectionOutlineShadowSize: 50,

        // For faster rendering
        groupFillType: "plain",
        groupLabelMinFontSize: 20,
        titleBarMinFontSize: 20,

        groupGrowingDuration: 300,
        //rolloutStartPoint: 'bottomright',

      };

      let preConfigFoamTree : any = {
        descriptionGroupType: 'stab',
        exposeDuration: 400,
        exposeEasing: "linear",
        groupLabelFontFamily: "Oxygen",
        rolloutEasing: "squareInOut",
        rolloutScalingStrength: -0.3,
        rolloutRotationStrength: 0,
        pullbackEasing: "squareInOut",
        pullbackDuration: 2000,
        pullbackScalingStrength: -0.3,
        pullbackRotationStrength: 0,
        pullbackPolygonDelay: 0.1,
        fadeDuration: 0,
        attributionPosition: 45,
        relaxationVisible: true,
        groupGrowingDuration: 500,
        layout: 'relaxed',//squarified, ordered, relaxed
        //stacking: 'flattened',

        dataObject: {
            groups: groups,
          },
         

      };
      //console.log('thisFoamTree', thisFoamTree );
      return preConfigFoamTree;

}

export function getFakeFoamTreeGroups( weightFlatness: number, maxWeight: number, thisLayer: string[], childLayers?: string[][] ) {
    let arr : IFoamTreeGroup[] = [];
    thisLayer.map ( ( group0, index ) => {
        let thisGroup : IFoamTreeGroup = {
            label: group0,
            weight: getWeight( weightFlatness, maxWeight ),

        };
        if ( childLayers !== null && childLayers != undefined && childLayers.length > 0 ) { 
            thisGroup.groups = getFakeFoamTreeGroups( weightFlatness, maxWeight, childLayers[index] ) ;
            let childrenWeight = 0;
            thisGroup.groups.map( g => { childrenWeight += g.weight ; });
            thisGroup.weight = childrenWeight;
        }

        arr.push( thisGroup );
    }) ;
    return arr;
  }

  /**
   * 
   * @param weightFlatness:  number 1 to 99
   * 90 represents the range is between 10 and 99 % of the max;
   * 
   * 
   */
  function getWeight( weightFlatness: number, maxWeight: number ) {

    let maxDownAdjust = weightFlatness * maxWeight / 100;
    let weight : number = maxWeight - ( Math.random() ) * maxDownAdjust ;

    return weight;

  }